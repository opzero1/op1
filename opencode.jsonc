{
  "$schema": "https://opencode.ai/config.json",
  
  // =============================================
  // OPENCODE HARNESS - OpenCode Configuration
  // The best of oh-my-opencode + opencode-workspace
  // Minimal plugins, maximum capability via skills/commands
  // =============================================

  // =============================================
  // PLUGINS
  // Harness notify plugin: in-app toasts, focus detection, sounds, quiet hours
  // Harness workspace plugin: project-scoped plan management
  // =============================================
  "plugin": [
    "./.opencode/plugin/notify/notify.js",
    "./.opencode/plugin/workspace/workspace.js"
  ],

  // Default model - change to your preferred model
  "model": "anthropic/claude-sonnet-4-20250514",
  "small_model": "anthropic/claude-sonnet-4-20250514",
  
  // Default agent when none specified
  "default_agent": "build",

  // =============================================
  // PERMISSION DEFAULTS
  // =============================================
  "permission": {
    "edit": "allow",
    "bash": "allow",
    "task": "allow",
    "skill": "allow",
    "glob": "allow",
    "grep": "allow",
    "read": "allow",
    "webfetch": "allow",
    "websearch": "allow",
    "codesearch": "allow",
    "todowrite": "allow",
    "todoread": "allow",
    "question": "allow"
  },

  // =============================================
  // MCP SERVERS
  // =============================================
  "mcp": {
    // ----- Z.AI Coding Plan MCPs -----
    // Get your API key at: https://z.ai/manage-apikey/apikey-list
    
    // Vision MCP - Image/video analysis, UI screenshots, diagrams
    // Tools: ui_to_artifact, extract_text_from_screenshot, diagnose_error_screenshot,
    //        understand_technical_diagram, analyze_data_visualization, ui_diff_check,
    //        image_analysis, video_analysis
    "zai-vision": {
      "type": "local",
      "command": ["bunx", "-y", "@z_ai/mcp-server"],
      "environment": {
        "Z_AI_API_KEY": "{env:Z_AI_API_KEY}",
        "Z_AI_MODE": "ZAI"
      }
    },
    // Web Search MCP - Real-time web search
    // Tools: webSearchPrime
    "zai-search": {
      "type": "remote",
      "url": "https://api.z.ai/api/mcp/web_search_prime/mcp",
      "headers": {
        "Authorization": "Bearer {env:Z_AI_API_KEY}"
      }
    },
    // Web Reader MCP - Fetch and parse webpage content
    // Tools: webReader
    "zai-reader": {
      "type": "remote",
      "url": "https://api.z.ai/api/mcp/web_reader/mcp",
      "headers": {
        "Authorization": "Bearer {env:Z_AI_API_KEY}"
      }
    },
    // Zread MCP - GitHub repo understanding (docs, structure, code)
    // Tools: search_doc, get_repo_structure, read_file
    "zai-zread": {
      "type": "remote",
      "url": "https://api.z.ai/api/mcp/zread/mcp",
      "headers": {
        "Authorization": "Bearer {env:Z_AI_API_KEY}"
      }
    },

    // ----- Project Management MCPs -----
    // Uses OAuth - will prompt for authentication on first use
    
    // Linear MCP - Issue tracking
    // Tools: linear_list_issues, linear_get_issue, linear_create_issue, linear_search_issues
    "linear": {
      "type": "local",
      "command": ["bunx", "-y", "mcp-remote", "https://mcp.linear.app/mcp"]
    },
    // Notion MCP - Documentation and knowledge base
    // Tools: notion_notion-search, notion_notion-fetch, notion_notion-list-databases
    "notion": {
      "type": "local",
      "command": ["bunx", "-y", "mcp-remote", "https://mcp.notion.com/mcp"]
    },

    // ----- Parity MCPs (from oh-my-opencode / opencode-workspace) -----
    
    // Context7 - Library/docs lookup
    // Tools: resolve-library-id, get-library-docs
    // Low cost, high utility - use for documentation first
    "context7": {
      "type": "remote",
      "url": "https://mcp.context7.com/mcp"
    },
    // Grep.app - GitHub code search
    // Tools: search (searches public GitHub repos)
    // Medium cost - use for finding real-world patterns
    "grep_app": {
      "type": "remote",
      "url": "https://mcp.grep.app"
    },
  },

  // =============================================
  // TOOL VISIBILITY
  // Disable MCP tools globally to keep main agent context clean
  // Subagents enable specific tools via their agent config
  // =============================================
  "tools": {
    // Disable all MCP tools globally
    // This keeps main agent context clean
    // Subagents enable specific tools via their agent config
    "zai-vision_*": false,
    "zai-search_*": false,
    "zai-reader_*": false,
    "zai-zread_*": false,
    "linear_*": false,
    "notion_*": false,
    "context7_*": false,
    "grep_app_*": false,
  },

  // =============================================
  // AGENT-SPECIFIC TOOL OVERRIDES
  // =============================================
  "agent": {
    // Researcher gets all research + project management MCPs
    "researcher": {
      "tools": {
        "zai-search_*": true,
        "zai-reader_*": true,
        "zai-zread_*": true,
        "linear_*": true,
        "notion_*": true,
        "context7_*": true,
        "grep_app_*": true,
      }
    },
    // Coder gets vision + context7 MCPs for UI analysis/debugging and docs
    "coder": {
      "tools": {
        "context7_*": true,
        "zai-vision_*": true
      }
    },
    // Frontend gets vision + context7 MCPs for UI analysis and docs
    "frontend": {
      "tools": {
        "context7_*": true,
        "zai-vision_*": true
      }
    }
  },

  // =============================================
  // COMPACTION SETTINGS
  // =============================================
  "compaction": {
    "auto": true,
    "prune": true
  }
}
